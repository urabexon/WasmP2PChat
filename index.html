<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WasmP2PChat</title>
    <link rel="stylesheet" href="https://cdn.rawgit.com/Chalarangelo/mini.css/v3.0.1/dist/mini-default.min.css">
</head>
<body>
    <header class="sticky row">
        <h4>WasmP2PChat</h4>
    </header>
    <div>
        <p><button onclick="window.startNewChat()" class="secondary">START</button></p>
        <input id="message" type="text" value="Hello ðŸ‘‹"></input>
        <button onclick="window.sendMessage()" class="primary">SEND</button>
        <h4>RECORD</h4>
        <textarea style="height:600px;width:600px;" id="logs" readonly></textarea>
    </div>
</body>
</html>

<script src="wasm_exec.js"></script>
<script>
    window.MATCHMAKING_ORIGIN = "localhost:8081";
    window.SIGNALING_ORIGIN   = "localhost:8082";

    const go = new Go();
    (async () => {
        try {
            const r = await WebAssembly.instantiateStreaming(fetch("main.wasm"), go.importObject);
            go.run(r.instance);
        } catch (e) {
            console.warn("instantiateStreaming fallback:", e);
            const bytes = await (await fetch("main.wasm")).arrayBuffer();
            const r = await WebAssembly.instantiate(bytes, go.importObject);
            go.run(r.instance);
        }
    })();
</script>
